ORG	00H
MOV	SP,#80H
MOV	PSW,#00H

RS	EQU P2.0
RW	EQU P2.1
ENBL	EQU P2.2

MAIN_PASSWORD:

MOV 60H,#31H; 1
MOV 61H,#37H; 7
MOV 62H,#41H; A
MOV 63H,#32H; 2
MOV 64H,#47H; G
MOV 65H,#52H; R
MOV 66H,#4FH; O
MOV 67H,#55H; U
MOV 68H,#50H; P
MOV 69H,#31H; 1

MOV P3,#0FFH


MOV	A,#38H
LCALL	COMMAND
LCALL	DELAY

MOV	A,#0EH
LCALL	COMMAND
LCALL	DELAY

MOV	A,#01H
LCALL	COMMAND
LCALL	DELAY


MOV	A,#06H
LCALL	COMMAND
LCALL	DELAY


MOV	A,#80H
LCALL	COMMAND
LCALL	DELAY
ACALL	DELAY    

RESETP:	MOV DPTR,#MSG4		;PRINTING USERNAME 	

UNAME:
	CLR A
	MOVC A,@A+DPTR
	JZ FINISH_1
	LCALL DISPLAY
	LCALL DELAY
	INC DPTR
	LJMP UNAME

FINISH_1:
	MOV A,#0C0H
	LCALL COMMAND
	LCALL DELAY  

	MOV DPTR,#MSG1		;PRINTING PASSWORD 	

PASSWORD:	
	CLR A
	MOVC A,@A+DPTR
	JZ FINISH_2
	LCALL DISPLAY
	LCALL DELAY
	INC DPTR
	LJMP PASSWORD


FINISH_2: 
        MOV	A,#89H
	LCALL	COMMAND
	LCALL	DELAY
	
	MOV R0,#40H
	MOV R5,#04H
	
USER: 	LCALL KEYPAD
	DJNZ R5,USER
	
	MOV	A,#0C9H
	LCALL	COMMAND
	LCALL	DELAY
	
	MOV R5,#06H
PASS: 	LCALL KEYPAD2
	DJNZ R5,PASS
 
 MOV 	R5,#10
 MOV 	R0,#40H
 MOV 	R1,#60H

COMPARE:  MOV A,@R0
	  MOV R7,A
	  MOV A,@R1	
	  CJNE A,07H,EXIT
	  INC R0
	  INC R1
	  DJNZ R5,COMPARE

	MOV	A,#01H 		;CLEAR SCREEN
	LCALL	COMMAND
	LCALL	DELAY
	
	MOV DPTR,#MSG2 		;ACCESS GRANTED
	
	

GRANT:	CLR A
	MOVC A,@A+DPTR
	JZ GRANT_1
	LCALL DISPLAY
	LCALL DELAY
	INC DPTR
	LJMP GRANT
	
GRANT_1: 
	MOV	A,#0C0H 	;CLEAR SCREEN
	LCALL	COMMAND
	LCALL	DELAY
	
	MOV DPTR,#MSG5 		;ACCESS GRANTED

GRANT_2:	
	CLR A
	MOVC A,@A+DPTR
	JZ FINISH_7
	LCALL DISPLAY
	LCALL DELAY
	INC DPTR
	LJMP GRANT_2

FINISH_7: LJMP HERE
	 
EXIT: 	MOV	A,#01H
	LCALL	COMMAND
	LCALL	DELAY
	MOV DPTR,#MSG3 	
	
	

EXIT_1:	CLR A
	MOVC A,@A+DPTR
	JZ EXIT_2
	LCALL DISPLAY
	LCALL DELAY
	INC DPTR
	LJMP EXIT_1
	
EXIT_2: MOV	A,#0C0H
	LCALL	COMMAND
	LCALL	DELAY
	MOV DPTR,#MSG6	
	
	
EXIT_3:	CLR A
	MOVC A,@A+DPTR
	JZ FINISH_8
	LCALL DISPLAY
	LCALL DELAY
	INC DPTR
	LJMP EXIT_3

FINISH_8:ACALL DELAY

HERE:	SJMP HERE
	
COMMAND:
	LCALL READY
	MOV P1,A
	CLR RS
	CLR RW
	SETB ENBL
	LCALL DELAY
	CLR ENBL
	RET

DISPLAY:
	LCALL READY
	MOV P1,A
	SETB RS
	CLR RW
	SETB ENBL
	LCALL DELAY
	CLR ENBL
	RET

READY:	SETB P1.7
	CLR RS
	SETB RW

WAIT:	CLR ENBL
	ACALL DELAY
	SETB ENBL
	JB P1.7,WAIT
	RET

DELAY:	
		MOV R3,#55
	AGAIN_2:
		MOV R4,#255
	AGAIN:
		DJNZ R4,AGAIN
		DJNZ R3,AGAIN_2
		RET

DELAY_20m:	
		MOV	R2, #43
	L3:	MOV	R3, #6
	L2:	MOV	R4, #37
	L1:	DJNZ	R4, L1
		DJNZ	R3, L2
		DJNZ	R2, L3
		NOP
		NOP
		RET
KEYPAD:
K1: 	MOV P0,#00H
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,K1

K2:	ACALL DELAY_20m
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,OVER
	SJMP K2

OVER:	ACALL DELAY_20m
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,OVER1
	SJMP K2

OVER1:	MOV P0,#11111110B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_0
	
	MOV P0,#11111101B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_1

	MOV P0,#11111011B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_2
	
	MOV P0,#11110111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_3
	
	MOV P0,#11101111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_4
	
	MOV P0,#11011111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_5
	
	MOV P0,#10111111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_6
	
	MOV P0,#01111111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_7
	LJMP K2

ROW_0:  MOV DPTR,#KCODE0
	SJMP FIND

ROW_1:  MOV DPTR,#KCODE1
	SJMP FIND

ROW_2:  MOV DPTR,#KCODE2
	SJMP FIND

ROW_3:  MOV DPTR,#KCODE3
	SJMP FIND
	
ROW_4:  MOV DPTR,#KCODE4
	SJMP FIND
	
ROW_5:  MOV DPTR,#KCODE5
	SJMP FIND
	
ROW_6:  MOV DPTR,#KCODE6
	SJMP FIND
	
ROW_7:  MOV DPTR,#KCODE7
	SJMP FIND

FIND:	RRC A
	JNC MATCH
	INC DPTR
	SJMP FIND

 

MATCH:	CLR A
	MOVC A,@A+DPTR
	CJNE A, #0FFH, ON_AC
	MOV A, #01
	LCALL COMMAND
	LCALL DELAY
	LJMP RESETP
ON_AC:	MOV  @R0,A
	LCALL DISPLAY
	LCALL DELAY
	INC R0 
	RET

KEYPAD2:

K12: 	MOV P0,#00H
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,K12

K22:	ACALL DELAY_20m
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,OVER2
	SJMP K22

OVER2:	ACALL DELAY_20m
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,OVER12
	SJMP K22

OVER12:	MOV P0,#11111110B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_00
	
	MOV P0,#11111101B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_11

	MOV P0,#11111011B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_22
	
	MOV P0,#11110111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_33
	
	MOV P0,#11101111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_44
	
	MOV P0,#11011111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_55
	
	MOV P0,#10111111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_66

	MOV P0,#01111111B
	MOV A,P3
	ANL A,#11111111B
	CJNE A,#11111111B,ROW_77
	LJMP K22

ROW_00: MOV DPTR,#KCODE0
	SJMP FIND2

ROW_11: MOV DPTR,#KCODE1
	SJMP FIND2

ROW_22: MOV DPTR,#KCODE2
	SJMP FIND2

ROW_33: MOV DPTR,#KCODE3
	SJMP FIND2
	
ROW_44: MOV DPTR,#KCODE4
	SJMP FIND2
	
ROW_55: MOV DPTR,#KCODE5
	SJMP FIND2
	
ROW_66: MOV DPTR,#KCODE6
	SJMP FIND2
	
ROW_77: MOV DPTR,#KCODE7
	SJMP FIND2
	

FIND2:	RRC A
	JNC MATCH2
	INC DPTR
	SJMP FIND2

 

MATCH2:	CLR A
	MOVC A,@A+DPTR
	CJNE A, #0FFH, ON_AC2
	MOV A, #01
	LCALL COMMAND
	LCALL DELAY
	LJMP RESETP
ON_AC2:
	MOV  @R0,A
	MOV A,#'*'
	LCALL DISPLAY
	LCALL DELAY
	INC R0 
	
	RET
		
	
MSG1:	DB 'PASSWORD:',0
MSG2:	DB 'Congratulations!',0
MSG3:	DB 'Sorry!',0
MSG4:	DB 'USERNAME:',0
MSG5:   DB 'Welcome to X',0
MSG6:   DB 'Try Again',0
KCODE0: DB 'A','B','C','D','E','F','G','H'
KCODE1: DB 'I','J','K','L','M','N','O','P'
KCODE2: DB 'Q','R','S','T','U','V','W','X'
KCODE3: DB 'Y','Z','0','1','2','3','4','5'
KCODE4: DB '6','7','8','9','`','!','@','#'
KCODE5: DB '$','%','^','&','*','(',')','-'
KCODE6: DB '=','_','+','[',']',':',060H,'<'
KCODE7: DB '>','/',05CH,'.',02CH,0FFH,3FH,00H
	END	
